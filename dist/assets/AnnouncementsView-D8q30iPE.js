import{f as z,g as m,m as B,c as n,a as e,i as f,e as F,F as S,n as q,h as U,j as p,v as y,t as u,b as L,o as d}from"./index-ccbdet2U.js";import{u as T}from"./advisor-D7NZ8dGp.js";import"./supabase-1JXeVZ6_.js";const E={class:"pb-5 border-b border-gray-200 sm:flex sm:items-center sm:justify-between"},H={class:"mt-3 sm:mt-0 sm:ml-4"},G={class:"mt-8"},J={key:0,class:"text-center py-4"},K={key:1,class:"text-center py-4 bg-white shadow rounded-lg"},O={key:2,class:"space-y-4"},P={class:"px-4 py-5 sm:px-6 flex justify-between items-start"},Q={class:"text-lg leading-6 font-medium text-gray-900"},R={class:"mt-1 max-w-2xl text-sm text-gray-500"},W={class:"flex space-x-2"},X=["onClick"],Y=["onClick"],Z={class:"border-t border-gray-200"},I={class:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ee={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 whitespace-pre-line"},te={key:0,class:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},se={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},le={class:"flex items-center"},ie=["onClick"],oe={key:0,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},ne={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},de={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},re={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ae={class:"sm:flex sm:items-start"},me={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},ue={class:"mt-4 space-y-4"},fe={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert"},ce={class:"block sm:inline"},ge={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ve=["disabled"],xe=["disabled"],be={key:1,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},pe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ye={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},we={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},he={class:"sm:flex sm:items-start"},ke={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},_e={class:"mt-4 space-y-4"},Ce={key:0,class:"mb-2 flex items-center"},Ue={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert"},je={class:"block sm:inline"},Ve={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Ae=["disabled"],$e=["disabled"],Me={key:2,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},De={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ne={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},ze={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Be=["disabled"],Fe=["disabled"],Ee=z({__name:"AnnouncementsView",setup(Se){const a=T(),c=m([]),w=m(!0),r=m(null),o=m(!1),g=m(!1),v=m(!1),x=m(!1),i=m({id:"",title:"",description:"",fileUrl:"",file:null,fileName:""}),b=m(null);B(async()=>{try{await a.fetchAnnouncements(),c.value=a.announcements}catch(s){r.value=s.message}finally{w.value=!1}});const h=s=>{const t=s.target;t.files&&t.files.length>0&&(i.value.file=t.files[0],i.value.fileName=t.files[0].name)},j=async()=>{try{o.value=!0,r.value=null,await a.createAnnouncement({title:i.value.title,description:i.value.description},i.value.file),k(),g.value=!1,c.value=a.announcements}catch(s){r.value=s.message}finally{o.value=!1}},V=s=>{b.value=s,i.value={id:s.id,title:s.title,description:s.description||"",fileUrl:s.fileUrl||"",file:null,fileName:""},v.value=!0},A=async()=>{try{o.value=!0,r.value=null,await a.updateAnnouncement(i.value.id,{title:i.value.title,description:i.value.description,fileUrl:i.value.fileUrl},i.value.file),k(),v.value=!1,await a.fetchAnnouncements(),c.value=a.announcements}catch(s){r.value=s.message}finally{o.value=!1}},$=s=>{b.value=s,x.value=!0},M=async()=>{if(b.value)try{o.value=!0,r.value=null,await a.deleteAnnouncement(b.value.id),x.value=!1,c.value=a.announcements}catch(s){r.value=s.message}finally{o.value=!1}},D=()=>{i.value.fileUrl=""},k=()=>{i.value={id:"",title:"",description:"",fileUrl:"",file:null,fileName:""},b.value=null},N=s=>{const t=typeof s=="string"?new Date(s):s;return new Intl.DateTimeFormat("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},_=s=>{window.open(s,"_blank")};return(s,t)=>(d(),n("div",null,[e("div",E,[t[13]||(t[13]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"จัดการประกาศ",-1)),e("div",H,[e("button",{onClick:t[0]||(t[0]=l=>g.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},t[12]||(t[12]=[e("svg",{class:"-ml-1 mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),F(" สร้างประกาศใหม่ ")]))])]),e("div",G,[w.value?(d(),n("div",J,t[14]||(t[14]=[e("div",{class:"text-sm text-gray-500"},"กำลังโหลดข้อมูล...",-1)]))):c.value.length===0?(d(),n("div",K,t[15]||(t[15]=[e("div",{class:"text-sm text-gray-500"},"ยังไม่มีประกาศ",-1)]))):(d(),n("div",O,[(d(!0),n(S,null,q(c.value,l=>(d(),n("div",{key:l.id,class:"bg-white shadow overflow-hidden sm:rounded-lg"},[e("div",P,[e("div",null,[e("h3",Q,u(l.title),1),e("p",R," วันที่ประกาศ: "+u(N(l.createdAt)),1)]),e("div",W,[e("button",{onClick:C=>V(l),class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," แก้ไข ",8,X),e("button",{onClick:C=>$(l),class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," ลบ ",8,Y)])]),e("div",Z,[e("dl",null,[e("div",I,[t[16]||(t[16]=e("dt",{class:"text-sm font-medium text-gray-500"}," รายละเอียด ",-1)),e("dd",ee,u(l.description),1)]),l.fileUrl?(d(),n("div",te,[t[18]||(t[18]=e("dt",{class:"text-sm font-medium text-gray-500"}," ไฟล์แนบ ",-1)),e("dd",se,[e("div",le,[t[17]||(t[17]=e("svg",{class:"h-5 w-5 text-gray-400 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z","clip-rule":"evenodd"})],-1)),e("button",{onClick:C=>_(l.fileUrl),class:"text-indigo-600 hover:text-indigo-900"}," ดาวน์โหลดไฟล์ ",8,ie)])])])):f("",!0)])])]))),128))]))]),g.value?(d(),n("div",oe,[e("div",ne,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[1]||(t[1]=l=>g.value=!1)}),t[23]||(t[23]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",de,[e("form",{onSubmit:U(j,["prevent"])},[e("div",re,[e("div",ae,[e("div",me,[t[22]||(t[22]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"}," สร้างประกาศใหม่ ",-1)),e("div",ue,[e("div",null,[t[19]||(t[19]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"หัวข้อประกาศ",-1)),p(e("input",{type:"text",id:"title","onUpdate:modelValue":t[2]||(t[2]=l=>i.value.title=l),class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[y,i.value.title]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"รายละเอียด",-1)),p(e("textarea",{id:"content","onUpdate:modelValue":t[3]||(t[3]=l=>i.value.description=l),rows:"4",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[y,i.value.description]])]),e("div",null,[t[21]||(t[21]=e("label",{for:"file",class:"block text-sm font-medium text-gray-700"},"ไฟล์แนบ (ถ้ามี)",-1)),e("input",{type:"file",id:"file",onChange:h,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,32)]),r.value?(d(),n("div",fe,[e("span",ce,u(r.value),1)])):f("",!0)])])])]),e("div",ge,[e("button",{type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",disabled:o.value},u(o.value?"กำลังบันทึก...":"บันทึก"),9,ve),e("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[4]||(t[4]=l=>g.value=!1),disabled:o.value}," ยกเลิก ",8,xe)])],32)])])])):f("",!0),v.value?(d(),n("div",be,[e("div",pe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[5]||(t[5]=l=>v.value=!1)}),t[29]||(t[29]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ye,[e("form",{onSubmit:U(A,["prevent"])},[e("div",we,[e("div",he,[e("div",ke,[t[28]||(t[28]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"}," แก้ไขประกาศ ",-1)),e("div",_e,[e("div",null,[t[24]||(t[24]=e("label",{for:"edit-title",class:"block text-sm font-medium text-gray-700"},"หัวข้อประกาศ",-1)),p(e("input",{type:"text",id:"edit-title","onUpdate:modelValue":t[6]||(t[6]=l=>i.value.title=l),class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[y,i.value.title]])]),e("div",null,[t[25]||(t[25]=e("label",{for:"edit-content",class:"block text-sm font-medium text-gray-700"},"รายละเอียด",-1)),p(e("textarea",{id:"edit-content","onUpdate:modelValue":t[7]||(t[7]=l=>i.value.description=l),rows:"4",class:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[y,i.value.description]])]),e("div",null,[t[27]||(t[27]=e("label",{for:"edit-file",class:"block text-sm font-medium text-gray-700"},"ไฟล์แนบ (ถ้ามี)",-1)),i.value.fileUrl?(d(),n("div",Ce,[t[26]||(t[26]=e("span",{class:"text-sm text-gray-500 mr-2"},"ไฟล์ปัจจุบัน:",-1)),e("button",{type:"button",onClick:t[8]||(t[8]=l=>_(i.value.fileUrl)),class:"text-indigo-600 hover:text-indigo-900 text-sm"}," ดูไฟล์ "),e("button",{type:"button",onClick:D,class:"ml-2 text-red-600 hover:text-red-900 text-sm"}," ลบไฟล์ ")])):f("",!0),e("input",{type:"file",id:"edit-file",onChange:h,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,32)]),r.value?(d(),n("div",Ue,[e("span",je,u(r.value),1)])):f("",!0)])])])]),e("div",Ve,[e("button",{type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",disabled:o.value},u(o.value?"กำลังบันทึก...":"บันทึก"),9,Ae),e("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[9]||(t[9]=l=>v.value=!1),disabled:o.value}," ยกเลิก ",8,$e)])],32)])])])):f("",!0),x.value?(d(),n("div",Me,[e("div",De,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[10]||(t[10]=l=>x.value=!1)}),t[31]||(t[31]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Ne,[t[30]||(t[30]=L('<div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"> ยืนยันการลบประกาศ </h3><div class="mt-2"><p class="text-sm text-gray-500"> คุณแน่ใจหรือไม่ว่าต้องการลบประกาศนี้? การกระทำนี้ไม่สามารถย้อนกลับได้ </p></div></div></div></div>',1)),e("div",ze,[e("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:M,disabled:o.value},u(o.value?"กำลังลบ...":"ลบ"),9,Be),e("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[11]||(t[11]=l=>x.value=!1),disabled:o.value}," ยกเลิก ",8,Fe)])])])])):f("",!0)]))}});export{Ee as default};
